var Select_List_Data = {
    subjects: {
        1: {
            text: [
                "رياضيات 1",
                "رياضيات 2",
                "مبادئ عمل الحواسيب 1",
                "مبادئ عمل الحواسيب 2",
                "لغة إنكليزية 1",
                "لغة إنكليزية 2",
                "لغة عربية",
                "ثقافة",
                "جبربول ومبادئ المنطق",
                "برمجة 1",
                "برمجة 2",
                "دارات الكترونية 1",
                "دارات الكترونية 2",
                "تحليل عددي 1",
            ],
            value: [
                "رياضيات 1",
                "رياضيات 2",
                "مبادئ عمل الحواسيب 1",
                "مبادئ عمل الحواسيب 2",
                "لغة إنكليزية 1",
                "لغة إنكليزية 2",
                "لغة عربية",
                "ثقافة",
                "جبربول ومبادئ المنطق",
                "برمجة 1",
                "برمجة 2",
                "دارات الكترونية 1",
                "دارات الكترونية 2",
                "تحليل عددي 1",
            ],
        },
        2: {
            text: [
                "خوارزميات وبنى المعطيات 1",
                "خوارزميات وبنى المعطيات 2",
                "بنيان الحواسيب 1",
                "برمجة متقدمة 1",
                "رياضيات متقطعة",
                "برمجة الويب",
                "اللغة الإنكليزية 3",
                "اللغة الإنكليزية 4",
                "تطبيقات انترنت",
                "تحليل عددي 2",
                "احتمالات وإحصاء",
                "دارات منطقية",
            ],
            value: [
                "خوارزميات وبنى المعطيات 1",
                "خوارزميات وبنى المعطيات 2",
                "بنيان الحواسيب 1",
                "برمجة متقدمة 1",
                "رياضيات متقطعة",
                "برمجة الويب",
                "اللغة الإنكليزية 3",
                "اللغة الإنكليزية 4",
                "تطبيقات انترنت",
                "تحليل عددي 2",
                "احتمالات وإحصاء",
                "دارات منطقية",
            ],
        },
        3: {
            text: [
                "الاوتومات واللغات الصورية",
                "بحوث العمليات 1",
                "بحوث العمليات 2",
                "لغة إنكليزية تخصصية 1",
                "قواعد المعطيات 1",
                "مترجمات",
                "نظرية المعلومات",
                "ذكاء صنعي",
                "بنيان الحواسيب 2",
                "برمجة متقدمة 2",
                "هندسة البرمجيات 1",
                "اتصالات رقمية",
            ],
            value: [
                "الاوتومات واللغات الصورية",
                "بحوث العمليات 1",
                "بحوث العمليات 2",
                "لغة إنكليزية تخصصية 1",
                "قواعد المعطيات 1",
                "مترجمات",
                "نظرية المعلومات",
                "ذكاء صنعي",
                "بنيان الحواسيب 2",
                "برمجة متقدمة 2",
                "هندسة البرمجيات 1",
                "اتصالات رقمية",
            ],
        },
        4: {
            text: [
                "شبكات معلوماتية 1",
                "شبكات معلوماتية 2",
                "هندسة البرمجيات 2",
                "رسم وحاسب",
                "نظم المعلومات",
                "إدارة الشبكات",
                "نظم وسائط متعددة",
                "لغات برمجة",
                "تحليل وتصميم",
                "برمجة تفرعية",
                "نظم تشغيل 1",
                "نظم تشغيل 2",
                "قواعد معطيات 2",
                "أمن المعلومات",
                "لغة إنكليزية تخصصية 2",
                "نمذجة ومحاكاة",
            ],
            value: [
                "شبكات معلوماتية 1",
                "شبكات معلوماتية 2",
                "هندسة البرمجيات 2",
                "رسم وحاسب",
                "نظم المعلومات",
                "إدارة الشبكات",
                "نظم وسائط متعددة",
                "لغات برمجة",
                "تحليل وتصميم",
                "برمجة تفرعية",
                "نظم تشغيل 1",
                "نظم تشغيل 2",
                "قواعد معطيات 2",
                "أمن المعلومات",
                "لغة إنكليزية تخصصية 2",
                "نمذجة ومحاكاة",
            ],
        },
        5: {
            text: [
                "تجارة الكترونية وتسويق",
                "هندسة نظم المعلومات",
                "هندسة البرمجيات 3",
                "شبكات لاسلكية",
                "النظم و التطبيقات الموزعة",
                "لغة إنكليزية تخصصية 3",
                "أمن معلومات",
                "أمن شبكات",
                "بيو انفوماتيك",
                "نظم زمن حقيقي",
                "قواعد معطيات معرفية",
                "الروبوتية و الرؤية الحاسوبية",
                "إدارة المشاريع",
            ],
            value: [
                "تجارة الكترونية وتسويق",
                "هندسة نظم المعلومات",
                "هندسة البرمجيات 3",
                "شبكات لاسلكية",
                "النظم و التطبيقات الموزعة",
                "لغة إنكليزية تخصصية 3",
                "أمن معلومات",
                "أمن شبكات",
                "بيو انفوماتيك",
                "نظم زمن حقيقي",
                "قواعد معطيات معرفية",
                "الروبوتية و الرؤية الحاسوبية",
                "إدارة المشاريع",
            ],
        },
    },
};

function removeAllOptions(sel, removeGrp) {
    var len, groups, par;
    if (removeGrp) {
        groups = sel.getElementsByTagName("optgroup");
        len = groups.length;
        for (var i = len; i; i--) {
            sel.removeChild(groups[i - 1]);
        }
    }

    len = sel.options.length;
    for (var i = len; i; i--) {
        par = sel.options[i - 1].parentNode;
        par.removeChild(sel.options[i - 1]);
    }
}

function appendDataToSelect(sel, obj) {
    var f = document.createDocumentFragment();
    var labels = [],
        group,
        opts;

    function addOptions(obj) {
        var f = document.createDocumentFragment();
        var o;

        for (var i = 0, len = obj.text.length; i < len; i++) {
            o = document.createElement("option");
            o.appendChild(document.createTextNode(obj.text[i]));

            if (obj.value) {
                o.value = obj.value[i];
            }

            f.appendChild(o);
        }
        return f;
    }

    if (obj.text) {
        opts = addOptions(obj);
        f.appendChild(opts);
    } else {
        for (var prop in obj) {
            if (obj.hasOwnProperty(prop)) {
                labels.push(prop);
            }
        }

        for (var i = 0, len = labels.length; i < len; i++) {
            group = document.createElement("optgroup");
            group.label = labels[i];
            f.appendChild(group);
            opts = addOptions(obj[labels[i]]);
            group.appendChild(opts);
        }
    }
    sel.appendChild(f);
}

let year = document.getElementById("year");

if (year) {
    year.addEventListener("change", (e) => {
        var relName = "subjects";

        var relList = this.form.elements[relName];

        var obj = Select_List_Data[relName][this.value];

        removeAllOptions(relList, true);

        appendDataToSelect(relList, obj);
    });
}

let loginForm = document.getElementById("login-form");

loginForm.addEventListener("submit", (e) => {
    e.preventDefault();
    let email = document.getElementById("email").value;
    let password = document.getElementById("password").value;
    let mode = document.getElementById("mode").value;

    if (mode === "student") {
        axios
            .post("/api/user/login", {
                email: email,
                password: password,
            })
            .then(function (res) {
                sessionStorage.setItem("access_token", res.data.access_token);
                sessionStorage.setItem("isAdmin", res.data.isAdmin);
                window.location.href = "http://127.0.0.1:8000/student/${res.data.id}";
            });
    } else {
        axios
            .post("/api/doctor/login", {
                email: email,
                password: password,
                mode: mode,
            })
            .then(function (res) {
                sessionStorage.setItem("access_token", res.data.access_token);
                window.location.href = "http://127.0.0.1:8000/doctor/${res.data.id}";
            });
    }
});
